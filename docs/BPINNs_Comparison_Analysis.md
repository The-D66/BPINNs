# BPINNs Saint-Venant 1D: 对比分析报告

## 1. 概述

本报告旨在对比分析 Bayesian Physics-Informed Neural Networks (BPINNs) 在求解一维 Saint-Venant (浅水) 方程时的两种不同训练范式：**有监督混合训练 (Run 10)** 与 **无监督物理驱动训练 (Internal PDE)**。

通过这两组实验的对比，我们深入探讨了内部观测数据 (`sol`) 对模型精度、不确定性量化 (UQ) 以及训练稳定性的决定性影响，并详细阐述了在缺失内部数据时所采用的参数调整策略。

## 2. 实验设置对比

下表列出了两组实验的关键参数差异：

| 参数类别 | 参数项 | **Run 10 (有监督)** | **Internal PDE (无监督)** | 差异解读 |
| :--- | :--- | :--- | :--- | :--- |
| **数据配置** | **`sol` (内部观测点)** | **1500** | **0** | **核心差异**。Run 10 使用真实数据引导；Internal PDE 仅依赖物理方程。 |
| | `pde` (物理配点) | 2000 | **11536** | 无监督模式下，需大幅增加 PDE 点以覆盖全域，提供物理约束。 |
| | `bnd` (边界点) | 1024 | 1536 | 略微增强边界约束。 |
| **网络架构** | `n_layers` | 5 | **3** | 减小深度，防止无监督下的过拟合与震荡。 |
| | `n_neurons` | 100 | **50** | 减小宽度，限制模型容量，平滑解空间。 |
| | **`fourier_scale`** | 1.0 (Enabled) | **0.0** (Disabled) | **关键**。Fourier 特征能捕捉高频细节，但在无监督双曲方程中极易引发非物理震荡，故禁用。 |
| **物理模型** | **`viscosity`** | 0.005 | **0.05** | **关键**。无监督下将人工粘性增加 10 倍，以压制激波震荡，保证数值稳定性。 |
| **不确定性** | `noise_h_std_phys` | 0.2 | **0.5** | 增加先验噪声，强迫模型在无数据区域给出更宽的置信区间。 |
| | `noise_Q_std_phys` | 0.5 | **1.0** | 同上。 |
| | `uncertainty["pde"]` | 0.1 (强权重) | **0.5** (弱权重) | 降低 PDE 权重，允许解微偏离方程，换取覆盖率与稳定性。 |
| **训练参数** | `ADAM LR` | 1e-3 | **5e-4** | 降低学习率，避免在平坦的 Loss 地形中跳过极小值。 |

## 3. 结果分析

### 3.1 精度表现 (Accuracy)

*   **Run 10 (有监督)**:
    *   **Sol Error**: **0.02%**
    *   **分析**: 由于有 1500 个内部真实数据点作为强约束，网络实际上是在执行“插值”任务。PINN 极易收敛到真实解，精度极高。
*   **Internal PDE (无监督)**:
    *   **Sol Error**: **~5%**
    *   **分析**: 这是一个纯粹的“外推”求解任务。网络仅靠边界条件和 PDE 约束向内传播信息。考虑到双曲型方程信息的有限传播速度和数值耗散，5% 的误差在无监督 PINN 中属于合理且优秀的范围。

### 3.2 不确定性量化 (UQ Coverage)

*   **Run 10 (有监督)**:
    *   **UQ Width**: ~0.7% - 1.9%
    *   **特征**: 置信区间非常窄。
    *   **原因**: 数据点“钉死”了均值，且方差被数据拟合项（Loss data）强力压制。模型对预测结果“非常自信”。
*   **Internal PDE (无监督)**:
    *   **UQ Width**: **~15% - 40%**
    *   **特征**: 置信区间显著变宽，能够包络大部分真实解。
    *   **原因**: 缺乏内部数据，HMC 采样探索了更多满足 PDE 但形态各异的解（由于 `viscosity` 和 `noise` 参数的调整）。这正确反映了在缺乏观测时模型应有的“认知不确定性 (Epistemic Uncertainty)”。

### 3.3 稳定性与震荡 (Stability)

*   **原始尝试 (Boundary PDE Only)**:
    *   在无内部数据且无内部 PDE 约束时，解呈现剧烈的高频震荡。这是因为网络在内部完全自由，且 Fourier 特征放大了高频噪声。
*   **Internal PDE (Current)**:
    *   通过引入 **人工粘性 (0.05)** 和 **简化网络结构**，高频震荡被成功抑制。解呈现出物理合理的平滑过渡。

## 4. 结论与建议

1.  **数据是王道**：如果工程应用允许，哪怕只引入少量的稀疏观测点（如 Run 10），也能将精度从 5% 提升至 0.02%，并极大简化训练难度。
2.  **无监督需“妥协”**：在完全无监督的情况下，为了换取训练的收敛性和解的稳定性，我们必须：
    *   **牺牲高频细节**（禁用 Fourier，增加粘性）。
    *   **接受更宽的置信区间**（增加噪声先验）。
    *   **简化模型**（减少层数和神经元）。
3.  **策略有效性**：本次迭代采用的“ADAM 预训练 + HMC 采样 + 强正则化”策略，成功将一个原本发散/震荡的病态问题，转化为一个稳定且具有统计意义的求解过程。

## 5. 未来工作

*   **因果训练 (Causal Training)**：在无监督模式下，引入 Time-marching 策略，按时间顺序逐步推进训练，可能进一步降低误差。
*   **自适应权重**：动态调整 PDE 与 Boundary Loss 的权重，以平衡梯度。

---
*Report generated by Gemini CLI Agent, 2025.12.01*
